!function(){"use strict";angular.module("Advertisement",[]),angular.module("Badge",[]),angular.module("Forum",[]),angular.module("Game",[]),function(){angular.module("GuitarNeck",["Guitar"])}(),angular.module("Instrument",[]),angular.module("Layout",[]),angular.module("Lesson",[]),angular.module("SheetMusic",[]),angular.module("SongBook",["ngResource","ngFileUpload"]).config(["$translateProvider",function(a){for(var b in l)l.hasOwnProperty(b)&&a.translations(b,l[b])}]),angular.module("Theory",[]),angular.module("Tuning",[]),angular.module("User",[]),angular.module("Utilities",[]),angular.module("MusicTools",["ngRoute","ngAnimate","ngSanitize","ngResource","ngFileUpload","ui.bootstrap","pascalprecht.translate","angular-loading-bar","Utilities","Layout","Advertisement","Badge","Forum","Game","Instrument","Lesson","SongBook","Theory","Tuning","User"]).config(["$translateProvider","cfpLoadingBarProvider",function(a,b){for(var c in q)q.hasOwnProperty(c)&&a.translations(c,q[c]);a.preferredLanguage("en"),a.useSanitizeValueStrategy("sanitize"),b.includeSpinner=!1}]),angular.module("Advertisement").config(["$routeProvider",function(a){}]),angular.module("Badge").config(["$routeProvider",function(a){}]),angular.module("Forum").config(["$routeProvider",function(a){}]),angular.module("Game").config(["$routeProvider",function(a){}]);var a=function(){};a.prototype.height=300,angular.module("GuitarNeck").controller("GuitarNeckController",a);var b=function(){return this};b.prototype.renderOptions={width:null,height:null,color:{font:"#161616","default":"#303030",highlight:"#444444"}},b.prototype.redraw=function(a,b,c){console.log("Abstract Layer is redrawn."),this.renderOptions.width=b,this.renderOptions.height=c;var d=a.getContext("2d");return null!==d&&(a.width=this.renderOptions.width,a.height=this.renderOptions.height),this},angular.module("GuitarNeck").controller("AbstractLayerController",b);var c=function(){return b.apply(this,arguments),this};c.prototype=Object.create(b.prototype),c.prototype.constructor=b,c.prototype.renderOptions.references={display:!0,highlight:!0,dotSize:10},c.prototype.renderOptions.numbers={display:!0,size:30,font:{size:12,weight:"bold",family:'"Helvetica Neue",Helvetica,Arial,sans-serif'}},c.prototype.fretFirst=0,c.prototype.fretLast=24,c.prototype.fretCount=24,c.prototype.redraw=function(a,c,d){console.log("Fret Layer is redrawn."),b.prototype.redraw.apply(this,arguments);var e=a.getContext("2d");return null!==e&&this.drawFrets(e),this},c.prototype.drawFrets=function(a){for(var b=15,c=(this.renderOptions.width-30)/(this.fretLast-this.fretFirst),d=this.fretFirst;d<=this.fretLast;d++){var e=this.fretIsHighlighted(d);e&&this.renderOptions.references.display&&this.drawFretReference(a,b-c/2,d),this.drawFret(a,b,d,e),b+=c}return this},c.prototype.fretIsHighlighted=function(a){var b=!1;if(this.renderOptions.references.highlight)if(0!==a&&a%12==0)b=!0;else{var c=a%12;13!==a&&10>c&&c%2!=0&&(b=!0)}return b},c.prototype.drawFret=function(a,b,c,d){a.beginPath();var e=3;this.renderOptions.references.highlight&&(0==c?e=9:d&&(e=5));var f=this.renderOptions.color["default"];d&&(f=this.renderOptions.color.highlight),0===b/.5%2&&(b+=.5);var g=this.renderOptions.height;return this.renderOptions.references.display&&(g-=2*this.renderOptions.references.dotSize),a.moveTo(b,0),a.lineTo(b,g),a.lineWidth=e,a.strokeStyle=f,a.closePath(),a.stroke(),this.renderOptions.numbers.display&&this.fretFirst!==c&&this.fretLast!==c&&this.drawFretNumber(a,b,c,d),this},c.prototype.drawFretNumber=function(a,b,c,d){var e=0,f=this.renderOptions.color["default"];return d&&(f=this.renderOptions.color.highlight),a.beginPath(),a.fillStyle=f,a.rect(b-this.renderOptions.numbers.size/2,e,this.renderOptions.numbers.size,this.renderOptions.numbers.size),a.closePath(),a.fill(),a.beginPath(),a.font=this.renderOptions.numbers.font.weight+" "+this.renderOptions.numbers.font.size+"px "+this.renderOptions.numbers.font.family,a.fillStyle=this.renderOptions.color.font,a.textAlign="center",a.shadowColor="transparent",a.textBaseline="middle",a.closePath(),a.fillText(c,b,e+this.renderOptions.numbers.size/2),this},c.prototype.drawFretReference=function(a,b,c){var d=!1;0===c%12&&(d=!0),a.beginPath(),a.fillStyle=this.renderOptions.color.highlight;var e=this.renderOptions.height-this.renderOptions.references.dotSize;return d?(a.arc(b+this.renderOptions.references.dotSize,e,this.renderOptions.references.dotSize/2,0,2*Math.PI,!1),a.arc(b-this.renderOptions.references.dotSize,e,this.renderOptions.references.dotSize/2,0,2*Math.PI,!1)):a.arc(b,e,this.renderOptions.references.dotSize/2,0,2*Math.PI,!1),a.closePath(),a.fill(),this},angular.module("GuitarNeck").controller("FretLayerController",c);var d=function(){return b.apply(this,arguments),this};d.prototype=Object.create(b.prototype),d.prototype.constructor=d,d.prototype.redraw=function(a,b,c){return console.log("Note Layer is redrawn."),this},angular.module("GuitarNeck").controller("NoteLayerController",d);var e=function(){return b.apply(this,arguments),this};e.prototype=Object.create(b.prototype),e.prototype.constructor=e,e.prototype.redraw=function(a,c,d){console.log("String Layer is redrawn."),b.prototype.redraw.apply(this,arguments);var e=a.getContext("2d");return null!==e&&this.drawStrings(e),this},e.prototype.drawStrings=function(a){return this},e.prototype.drawString=function(a,b){var c=this.notes.get(b),d=this.getStringPosition(a),e=.5*(a+1)+.5;this.context.beginPath(),this.context.moveTo(0,d),this.context.lineTo(this.width,d),this.context.lineWidth=e,this.context.strokeStyle=this.renderOptions.stringColor,this.context.shadowColor="#000",this.context.shadowBlur=4,this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.closePath(),this.context.stroke(),this.drawNote((this.renderOptions.notes.size+2)/2,d,c,this.renderOptions.notes.size,this.renderOptions.notes.defaultColor,this.renderOptions.notes.defaultFill,"#dddddd")},e.prototype.getStringPosition=function(a){var b=this.height.strings.interval*a+.5+this.height.strings.offset;return this.frets.showNumber&&(b+=this.renderOptions.fretNumberSize),b},angular.module("GuitarNeck").controller("StringLayerController",e),angular.module("GuitarNeck").directive("guitarNeckWidget",[function(){return{restrict:"E",templateUrl:assetDirectory+"/musictoolsinstrument/js/GuitarNeck/Partial/GuitarNeck.html",replace:!0,scope:{guitar:"=?"},controller:"GuitarNeckController",controllerAs:"guitarNeckCtrl",bindToController:!0,link:function(a,b,c){}}}]),angular.module("GuitarNeck").directive("fretLayer",["$window",function(a){return{restrict:"E",templateUrl:assetDirectory+"/musictoolsinstrument/js/GuitarNeck/Partial/Layer/FretLayer.html",replace:!0,scope:{fretFirst:"@",fretLast:"@",fretCount:"@"},controller:"FretLayerController",controllerAs:"fretLayerCtrl",bindToController:!0,link:function(b,c,d,e){var f=c.find("canvas").get(0);e.redraw(f,c.width(),c.height()),b.$watch(function(){return e.fretFirst},function(a,b){a!=b&&e.redraw(f,c.width(),c.height())}),b.$watch(function(){return e.fretLast},function(a,b){a!=b&&e.redraw(f,c.width(),c.height())}),b.$watch(function(){return e.fretCount},function(a,b){a!=b&&e.redraw(f,c.width(),c.height())}),$(a).on("resize",function(a){e.redraw(f,c.width(),c.height())})}}}]),angular.module("GuitarNeck").directive("noteLayer",["$window",function(a){return{restrict:"E",templateUrl:assetDirectory+"/musictoolsinstrument/js/GuitarNeck/Partial/Layer/NoteLayer.html",replace:!0,scope:{},controller:"NoteLayerController",controllerAs:"noteLayerCtrl",bindToController:!0,link:function(b,c,d,e){e.redraw(),$(a).on("resize",function(a){e.redraw()})}}}]),angular.module("GuitarNeck").directive("stringLayer",["$window",function(a){return{restrict:"E",templateUrl:assetDirectory+"/musictoolsinstrument/js/GuitarNeck/Partial/Layer/StringLayer.html",replace:!0,scope:{strings:"=?"},controller:"StringLayerController",controllerAs:"stringLayerCtrl",bindToController:!0,link:function(b,c,d,e){var f=c.get(0);e.redraw(f,c.width(),c.height()),$(a).on("resize",function(a){e.redraw(f,c.width(),c.height())})}}}]);var f=function(){};angular.module("Instrument").controller("ListViewController",[f]),angular.module("Instrument").directive("instrumentMenu",[function(){return{restrict:"E",templateUrl:"../app/Instrument/Partial/menu.html",replace:!0,scope:{},link:function(a,b,c){}}}]),function(){var a=function(){};a.prototype={current:null,getCurrent:function(){return this.current},setCurrent:function(a){this.current=a},list:function(){return[]}},angular.module("Instrument").factory("GuitarService",a)}(),angular.module("Instrument").config(["$routeProvider",function(a){a.when("/instruments",{templateUrl:"../app/Instrument/Partial/list.html",controller:"ListViewController",controllerAs:"listViewCtrl"})}]);var g=function(a){this.entity=a};g.prototype.entity=null,g.prototype.isNew=function(){var a=!0;return null!==this.entity&&"undefined"!=typeof this.entity.id&&null!==this.entity.id&&0!==this.entity.id.length&&(a=!1),a},g.prototype.validate=function(){this.entity.$create()},angular.module("Layout").controller("BaseFormController",["entity",g]),angular.module("Layout").directive("layoutHeader",[function(){return{restrict:"E",templateUrl:"../app/Layout/Partial/Header/navbar.html",replace:!0,scope:{},link:function(a,b,c){}}}]),angular.module("Layout").directive("layoutPageButton",[function(){return{restrict:"E",template:'<li role="presentation" data-ng-transclude=""></li>',replace:!0,transclude:!0,scope:{},link:function(a,b,c){}}}]),angular.module("Layout").directive("layoutPageButtons",[function(){return{restrict:"E",template:'<nav class="page-buttons navbar navbar-default"><ul class=" nav navbar-nav" data-ng-transclude=""></ul></nav>',replace:!0,transclude:!0,scope:{},link:function(a,b,c){}}}]),angular.module("Layout").directive("layoutPage",[function(){return{restrict:"E",templateUrl:"../app/Layout/Partial/Page/page.html",replace:!0,transclude:!0}}]),angular.module("Layout").directive("layoutPageTitle",[function(){return{restrict:"E",templateUrl:"../app/Layout/Partial/Page/title.html",replace:!0,transclude:!0,scope:{hideTitle:"@"}}}]),angular.module("Layout").directive("layoutSidebar",[function(){return{restrict:"E",templateUrl:"../app/Layout/Partial/Sidebar/sidebar.html",replace:!0,scope:{},link:function(a,b,c){}}}]),angular.module("Layout").directive("layoutSidebarItem",["$route",function(a){return{restrict:"E",templateUrl:"../app/Layout/Partial/Sidebar/sidebar-item.html",replace:!0,scope:{icon:"@",label:"@",url:"@"},link:function(b,c,d){b.current=!1,a.current&&a.current.regexp&&(b.current=a.current.regexp.test(b.url))}}}]),angular.module("Lesson").config(["$routeProvider",function(a){}]);var h=function(){};h.prototype.file=null,h.prototype.component={},h.prototype.player={ready:!1,state:0,component:{}},h.prototype.play=function(){this.player.component.Play()},h.prototype.pause=function(){this.player.component.Pause()},h.prototype.previousBar=function(){},h.prototype.nextBar=function(){},angular.module("SheetMusic").controller("SheetMusicController",h),function(){angular.module("SheetMusic").directive("sheetMusic",["$timeout",function(a){return{restrict:"E",templateUrl:assetDirectory+"/musictoolssongbook/js/SheetMusic/Partial/sheet-music.html",replace:!0,scope:{file:"@"},bindToController:!0,controller:"SheetMusicController",controllerAs:"sheetMusicCtrl",link:function(b,c,d,e){function f(){e.player.ready?$("#loadingInfo").hide():$("#loadingInfo").show()}e.component=$(".alphaTab");var g=$(c),h=g.offset(),i=g.width(),j=g.find(".sheet-music-controls");j.offset({left:h.left}),j.width(i),a(function(){e.component.alphaTab(),e.player.component=e.component.alphaTab("playerInit",{asRoot:assetDirectory+"/musictoolssongbook/libraries/alphaTab/Samples/JavaScript/lib/alphaSynth/",swfObjectRoot:assetDirectory+"/musictoolssongbook/libraries/alphaTab/Samples/JavaScript/lib/alphaSynth/"}),e.player.component.On("ready",function(a){e.player.component.LoadSoundFontUrl(assetDirectory+"/musictoolssongbook/libraries/alphaTab/Samples/JavaScript/lib/alphaSynth/default.sf2")}),e.player.component.On("soundFontLoad",function(a,b){var c=a/b*100|0;$("#sfInfo .progress").text("("+c+"%)")}),e.player.component.On("soundFontLoaded",function(){$("#sfInfo").hide()}),e.player.component.On("readyForPlay",function(a){f(),b.$apply()}),e.player.component.On("playerStateChanged",function(a){e.player.state=a,f(),b.$apply()}),e.component.alphaTab("playerCursor")},300)}}}])}();var i=function(a,b,c,d,e){g.apply(this,arguments),e.uploadPic=function(a){var f=this.isNew()?"POST":"PUT",g=this.isNew()?c.getServer()+"/songs":c.getServer()+"/songs/"+this.entity.id;a.upload=b.upload({url:g,method:f,data:{musictools_songbookbundle_song:{title:this.entity.title,artist:this.entity.artist,cover:{file:a}}}}),a.upload.then(function(b){d(function(){a.result=b.data})},function(a){a.status>0&&(e.errorMsg=a.status+": "+a.data)},function(b){a.progress=Math.min(100,parseInt(100*b.loaded/b.total))})}.bind(this)};i.prototype=Object.create(g.prototype),i.prototype.constructor=i,i.prototype.validate=function(){g.validate.apply(this,arguments)},i.prototype.uploadCover=function(a){},angular.module("SongBook").controller("SongFormController",["entity","Upload","ApiService","$timeout","$scope",i]);var j=function(a){console.log(a.length),this.entities=a};i.prototype.entities=[],angular.module("SongBook").controller("SongListController",["entities",j]);var k=function(a){this.entity=a};k.prototype.entity=null,angular.module("SongBook").controller("SongShowController",["entity",k]),angular.module("SongBook").factory("Song",["$resource","ApiService",function(a,b){return a(b.getServer()+"/songs/:id",{id:"@id"},{create:{method:"POST",transformRequest:function(a,b){var c={musictools_songbookbundle_song:a};return JSON.stringify(c)}},update:{method:"PUT",transformRequest:function(a,b){var c=JSON.stringify(a.productIntro);return c}}})}]),angular.module("SongBook").config(["$routeProvider",function(a){a.when("/songs",{templateUrl:"../app/SongBook/Partial/list.html",controller:"SongListController",controllerAs:"songListCtrl",resolve:{entities:["$route","Song",function(a,b){return b.query()}]}}).when("/songs/new",{templateUrl:"../app/SongBook/Partial/form.html",controller:"SongFormController",controllerAs:"songFormCtrl",resolve:{entity:["Song",function(a){return new a}]}}).when("/songs/:id",{templateUrl:"../app/SongBook/Partial/show.html",controller:"SongShowController",controllerAs:"songShowCtrl",resolve:{entity:["$route","Song",function(a,b){return b.get({id:a.current.params.id})}]}}).when("/songs/:id/edit",{templateUrl:"../app/SongBook/Partial/form.html",controller:"SongFormController",controllerAs:"songFormCtrl",resolve:{entity:["$route","Song",function(a,b){return b.get({id:a.current.params.id})}]}})}]);var l={};l.en={no_song_found:"No song found."},l.fr={no_song_found:"Aucun morceau trouvé."},angular.module("Theory").directive("noteDisplaySwitch",[function(){return{restrict:"A",controller:["NoteService",function(a){this.displayFlat=a.isDisplayFlat(),this.switchDisplay=function(){this.displayFlat=!this.displayFlat,a.setDisplayFlat(this.displayFlat)}}],controllerAs:"noteDisplaySwitchCtrl",bindToController:!0,link:function(a,b,c){}}}]),angular.module("Theory").directive("noteList",["NoteService",function(a){return{restrict:"E",templateUrl:assetDirectory+"/musictoolstheory/js/Note/Partial/list.html",replace:!0,scope:{},link:function(b,c,d){a.all().then(function(a){b.notes=a})}}}]),angular.module("Theory").directive("noteSelector",["NoteService",function(a){return{restrict:"E",templateUrl:assetDirectory+"/musictoolstheory/js/Note/Partial/selector.html",replace:!0,scope:{},controller:function(){},controllerAs:"noteSelectorCtrl",bindToController:!0,link:function(b,c,d){a.all().then(function(a){b.notes=a})}}}]);var m=function(a,b){return this.services.$http=a,this.services.$q=b,this};m.prototype.constructor=m,m.prototype.services={},m.prototype.displayFlat=!1,m.prototype.notes=[],m.prototype.current=null,m.prototype.getCurrent=function(){return this.current},m.prototype.setCurrent=function(a){return this.current=a,this},m.prototype.isDisplayFlat=function(){return this.displayFlat},m.prototype.setDisplayFlat=function(a){return a!==this.displayFlat&&(this.displayFlat=a,this.renameNotes()),this},m.prototype.renameNotes=function(){return this.apply(function(a){this.displayFlat?a.name=a.flatName:a.name=a.sharpName}.bind(this)),this},m.prototype.all=function(){return 0!==this.notes.length?this.notes:this.find()},m.prototype.find=function(){var a=this.services.$q.defer();return this.services.$http.get(Routing.generate("theory_note",{_format:"json"}),{}).success(function(b){this.notes=b,this.renameNotes(),a.resolve(b)}.bind(this)).error(function(b){a.reject(b)}),a.promise},m.prototype.get=function(a){return this.notes.find(function(b){return a==b.value})},m.prototype.addSemitone=function(a,b){var c=(a.value+b)%12;return this.get(c)},m.prototype.apply=function(a){if("function"==typeof a)for(var b=0;b<this.notes.length;b++)a(this.notes[b]);return this},angular.module("Theory").service("NoteService",["$http","$q",m]),angular.module("Theory").config(["$routeProvider",function(a){a.when("/theory",{templateUrl:"../app/Theory/Partial/index.html"})}]),function(){angular.module("GuitarTuning",[]).directive("tuningEdit",[function(){return{restrict:"E",templateUrl:"",replace:!0,scope:{headstock:"=",strings:"="}}}])}();var n=function(){};angular.module("User").controller("ProfileController",[n]);var o=function(){};angular.module("User").controller("SettingsController",[o]),angular.module("User").directive("userMenu",[function(){return{restrict:"E",templateUrl:"../app/User/Partial/menu.html",replace:!0,scope:{},link:function(a,b,c){}}}]),angular.module("User").config(["$routeProvider",function(a){a.when("/users",{templateUrl:"../app/User/Partial/list.html",controller:"ListViewController",controllerAs:"listViewCtrl"}),a.when("/profile",{templateUrl:"../app/User/Partial/profile.html",controller:"ProfileController",controllerAs:"profileCtrl"}),a.when("/profile/settings",{templateUrl:"../app/User/Partial/settings.html",controller:"SettingsController",controllerAs:"settingsCtrl"})}]);var p=function(){return this};p.prototype.constructor=p,p.prototype.server="/MusicTools/web/app_dev.php",p.prototype.getServer=function(){return this.server},angular.module("Utilities").service("ApiService",[p]),angular.module("MusicTools").config(["$routeProvider",function(a){}]);var q={};q.en={"link.instrument":"my instruments","link.song_book":"my songbook","link.theory":"theory","link.musician":"musicians","link.advertisement":"advertisement","link.game":"games","link.forum":"forum","link.lesson":"lessons"},q.fr={"link.instrument":"mes instruments","link.song_book":"my songbook","link.theory":"théorie","link.musician":"musiciens","link.advertisement":"annonces","link.game":"jeux","link.forum":"forum","link.lesson":"cours"}}();